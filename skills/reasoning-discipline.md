---
name: reasoning-discipline
description: "推理纪律协议。5合1工具的'关卡检查员'——强制LLM在thinking中按序完成每个推理阶段，每阶段有准入条件和反幻觉门槛。防止跳步、偷懒、凭空捏造因果链。必须与mr_if_reason工具配合使用。"
version: 1.0.0
---

# Reasoning Discipline Protocol — 推理纪律协议

## 为什么需要这个协议

mr_if_reason 工具一次性返回了：事件分类、链条模板、历史案例、验证框架、汇合规则。

如果你直接跳到结论，或者随便编几条链就去调外部工具——你的输出会是垃圾。

**这个协议是你 thinking 阶段的强制路线图。每个阶段(Gate)必须完成，才能进入下一阶段。**

---

## 阶段总览

```
Gate 1: 事件锚定（不许跑题）
  ↓
Gate 2: 链条构建（不许偷懒）
  ↓
Gate 3: 链条验证（不许自欺）
  ↓
Gate 4: 历史对照（不许无视）
  ↓
Gate 5: 汇合分析（不许单线思维）
  ↓
Gate 6: 二阶检测（不许卖共识）
  ↓
Gate 7: 出口检查（不许带病上线）
  ↓
→ 通过后才能调用外部工具（行业映射/证券映射/取数等）
```

---

## Gate 1: 事件锚定

**目的：** 确认你理解了用户说的是什么，以及你要从金融角度分析什么。

**必须输出：**
```
[Gate 1] 事件锚定
- 用户原文: "..."
- 金融解读: 用户的意思是... (永远从金融角度解读)
- mr_if_reason 分类: {type} (是否合理？如果分类不准确，手动修正)
- 季节语境: {season} (当前月份的季节性因素，是否与事件有交叉？)
- 推理方向: 从 mr_if_reason 返回的方向中，选择 2-4 个最相关的
```

**反幻觉检查：**
- 你是否在用金融视角解读？如果你的"金融解读"读起来像生活建议 → 停下，重来
- 事件分类是否准确？如果 mr_if_reason 把"特朗普发推"分类成 daily 而不是 geopolitical → 你手动修正
- 不要添加用户没说的东西。"今天冷了"只是天气事件，不要自行脑补成"流感爆发"

---

## Gate 2: 链条构建

**目的：** 基于 mr_if_reason 返回的模板，构建至少 3 条完整的因果链。

**规则：**
1. 使用 mr_if_reason 返回的 chain_templates，不要无视它们自己编
2. 每条链 3-7 步，每步必须标注：
   - 内容（这一步说的是什么）
   - 学科依据（引用 cross-domain-reasoning 的哪个学科）
   - 连接强度（strong / moderate / weak）
   - 连接理由（为什么上一步能推到这一步，一句话）
3. 最后一步必须落在具体行业或标的方向上
4. 至少有 2 条链来自不同学科维度

**必须输出：**
```
[Gate 2] 链条构建
Chain A: {模板名}
  Step 1: {内容} [学科] [strong] — 因为...
  Step 2: {内容} [学科] [strong] — 因为...
  ...
  → 结论: {行业/方向}

Chain B: {模板名}
  ...

Chain C: {模板名}
  ...
```

**反幻觉检查：**
- 每步的"因为..."是否能经得起追问？如果你自己都觉得勉强 → 标记为 weak
- 是否有"量子跳跃"？即上一步到下一步之间缺了一个关键中间环节 → 补上或标记
- 链条步数是否合理？超过5步 → 自问"中间有没有步骤可以合并？"
- 学科引用是否真实？"心理学上说..."——真的有这个理论吗？如果你不确定 → 不引用，用常识表述
- **最重要的：** 你是否真的在建链，还是在倒推？如果你心里已经有了"应该推荐能源股"这个结论，然后反向编了一条链 → 这是幻觉。正确的方式是：从事件出发，走到哪算哪。

---

## Gate 3: 链条验证

**目的：** 用 mr_if_reason 返回的 validation framework 给每条链打分。

**规则：**
1. 对每条链，逐一检查 6 个验证维度（逻辑连贯性、学科准确性、假设显性化、反面论证、时间一致性、规模合理性）
2. 应用加分/减分规则
3. 链条<4步 +1, 有历史先例 +1, 多链同向 +0.5~1.0
4. 链条>5步 -1, weak link -0.5(首个), -1.0(后续), 无alpha -1

**必须输出：**
```
[Gate 3] 链条验证
Chain A:
  - 逻辑连贯性: [通过/有弱点] — 具体说明
  - 学科准确性: [通过/存疑] — 具体说明
  - 假设显性化: 隐含假设是 [X], 当前环境下 [成立/不确定/不成立]
  - 反面论证: 如果 [Y] 发生，这条链完全失效
  - 时间一致性: [匹配/不匹配] — 时间窗口约 [Z]
  - 规模合理性: [合理/夸大/不足]
  - 评分: 基础3 + [加分] - [减分] = 最终X分
  - 判定: [可用 / 需补强 / 丢弃]

(Chain B, C 同样格式)
```

**反幻觉检查：**
- "反面论证"不能是走过场。你必须真的想出一个能让这条链失效的场景
- 如果你给自己的链全部打了高分 → 你在自欺。至少有一条链应该有明显的弱点
- 如果"隐含假设"你写了"无" → 不可能，任何推理都有隐含假设。重新想
- 评分必须诚实。如果一条链得分 < 2 → 直接丢弃，不要硬用

---

## Gate 4: 历史对照

**目的：** 将 mr_if_reason 返回的历史案例与你的链条对比。

**规则：**
1. 如果有匹配的历史案例 → 对比：相同点是什么？不同点是什么？
2. 如果结论一致 → 引用这个案例增强说服力
3. 如果结论不一致 → 必须解释"为什么这次不同"（且大幅降低置信度）
4. 如果没有匹配案例 → 标注"首次推理"，考虑是否需要调用网络检索工具查找

**必须输出：**
```
[Gate 4] 历史对照
匹配案例 1: {案例名}
  - 相似点: ...
  - 不同点: ...
  - 对我的推理的意义: [增强/削弱/中性]
  - 具体影响: 对 Chain [X] 的置信度 [+1 / -1 / 不变]

(如无匹配: "无直接匹配案例。Chain [X] 标注为首次推理。考虑用网络检索补充。")
```

**反幻觉检查：**
- 不要编造历史案例。只用 mr_if_reason 返回的案例 + 你确信真实存在的公开历史事件
- "这次不同"不能随便说。如果你说了 → 必须指出具体哪个结构性因素变了
- 不要选择性使用历史：如果一个案例同时支持你的一条链又反对另一条 → 都要说

---

## Gate 5: 汇合分析

**目的：** 检查多条链是否指向相同的方向，发现矛盾和增强点。

**规则：**
1. 把所有验证通过(得分>=2.5)的链条放在一起
2. 检查：哪些链指向相同行业/方向？（汇合 = 高置信）
3. 检查：哪些链对同一标的给出矛盾方向？（冲突 = 需要裁决）
4. 汇合规则：2链同向 +0.5, 3链同向 +1.0

**必须输出：**
```
[Gate 5] 汇合分析
汇合点:
  - {行业/方向} ← Chain A + Chain C 同向看多 → 置信度+0.5
冲突点:
  - {行业/方向} ← Chain A 看多 vs Chain B 看空 → 标记 mixed，裁决依据: ...
丢弃:
  - Chain X 得分过低，已丢弃

净方向:
  - 看多: {行业列表} (置信度: H/M/L)
  - 看空: {行业列表} (置信度: H/M/L)
  - 中性/混合: {行业列表} (原因)
```

**反幻觉检查：**
- 如果你的所有链条全部指向同一方向 → 你可能有确认偏差。回去 Gate 2 检查是否遗漏了反向链
- 冲突不是坏事，冲突是真实的。不要为了简洁而忽略冲突
- "净方向"必须只包含有链条支撑的方向。不能凭空加入"我觉得还可以看看XX"

---

## Gate 6: 二阶检测

**目的：** 确认你的推理不是在卖市场共识。

**规则（来自 second-order-thinking skill）：**
1. 对每个"净方向"，问：这个结论是市场共识吗？
2. 如果是共识 → 你的 alpha 在哪？找隐藏赢家/输家
3. 如果不是共识 → 你为什么比市场聪明？理由是什么？
4. 寻找时间错配：市场短期过度反应了什么？长期低估了什么？

**必须输出：**
```
[Gate 6] 二阶检测
结论 1: {看多 XX}
  - 市场共识？ [是/否/部分]
  - 如果是共识: 我的 edge 在于 [...]
  - 隐藏赢家: [不那么明显的受益者]
  - 隐藏输家: [不那么明显的受损者]
  - 时间错配: [短期过度反应?  / 长期被低估?]

(对每个净方向重复)
```

**反幻觉检查：**
- 如果你写了"市场共识：否"但你的推理其实很容易被任何分析师想到 → 你在骗自己
- "隐藏赢家"必须有逻辑链支撑（即使只有2步），不能随便联想
- 如果每个方向你都写了"否，我的推理很独特" → 你过于自信了。至少承认部分已被定价

---

## Gate 7: 出口检查（质量门）

**在调用任何外部工具之前，必须通过以下检查：**

```
[Gate 7] 出口检查
□ 1. 我构建了至少 3 条链吗？ (少于3条 → 回 Gate 2)
□ 2. 每条链都有学科依据吗？ (有无依据的步骤 → 标记 weak)
□ 3. 至少 2 条链来自不同学科维度吗？ (全部同学科 → 回 Gate 2 补)
□ 4. 我诚实地做了反面论证吗？ (走过场 → 回 Gate 3)
□ 5. 我检查了历史案例的一致/矛盾吗？ (跳过了 → 回 Gate 4)
□ 6. 汇合分析有结论吗？ (没有净方向 → 回 Gate 5)
□ 7. 二阶检测做了吗？ (全跳过 → 回 Gate 6)
□ 8. 我有具体的行业方向可以给行业映射工具吗？ (没有 → 推理不充分)
□ 9. 我的推理中没有编造的学科理论/历史事件吗？ (不确定 → 删除或标注不确定)
□ 10. 最终保留的链条至少有 1 条得分 >= 3 吗？ (全低分 → 降低整体置信度，向用户坦诚)
```

**全部通过 → 进入外部工具调用阶段**
**任何一项未通过 → 回到对应 Gate 补完**

---

## 反幻觉总原则

### 原则1: 不确定就说不确定
宁可说"这条链有一步我不太确定"，也不要编一个听起来很像的理论。你的用户是聪明人，他能接受不确定性，但他不能接受你胡编。

### 原则2: 不能倒推
正确：事件 → 推理 → 看到哪算到哪
错误：心里已经想好推荐什么 → 倒着编一条链来合理化
检测方法：如果你发现自己在想"怎么把这条链连到NVDA" → 你在倒推

### 原则3: 学科引用必须真实
可以："根据供需理论（经济学基本原理），供给减少+需求刚性→价格上涨"
不可以："根据克虏伯热力学第三扩展定律..."（不存在的理论）
不确定的处理：改用朴素表述 "常识上看..." "一般来说..."

### 原则4: 数字必须有来源
可以："美国天然气库存目前低于5年均值约15%（EIA数据）"
可以："天然气库存通常在冬季消耗，低于均值15%是看涨信号（引用cross-domain-reasoning）"
不可以："天然气库存低于均值43.7%"（如果你不确定具体数字，别编）
允许："天然气库存可能低于均值（需要通过取数工具确认）" → 然后真的去确认

### 原则5: 承认推理的边界
每条链都有一个"合理推测"的边界。超过这个边界就是联想而不是推理。
标记方法：当你觉得某一步"这个连接有点远" → 标注 [speculative]
3步合理推理 > 5步包含投机的链条
宁短勿长，宁少勿烂

---

## 与其他 Skill 的协作关系

```
mr_if_reason 工具返回 → 触发本协议
  │
  ├─ Gate 2 链条构建 → 参考 butterfly-effect-chain.md 的模式库和三定律
  │
  ├─ Gate 2-3 学科引用 → 参考 cross-domain-reasoning.md 的学科手册和桥接规则
  │                      特别注意"量化锚点"和"常见错误"
  │
  ├─ Gate 3 验证框架 → 使用 mr_if_reason 返回的评分维度
  │                    + cross-domain-reasoning.md 的交叉验证框架
  │
  ├─ Gate 6 二阶检测 → 参考 second-order-thinking.md 的5个检测工具
  │
  └─ Gate 7 出口检查 → 所有 skill 的综合质量门
```

---

## 关键词触发

推理纪律, 推理协议, 反幻觉, 质量检查, Gate, 链条验证, 出口检查,
reasoning discipline, anti-hallucination, quality gate, checkpoint
